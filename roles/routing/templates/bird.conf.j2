define DRAINED = 0;

log syslog all;
router id {{ router_id }};

timeformat base     iso long;
timeformat log      iso long;
timeformat protocol iso long;
timeformat route    iso long;

protocol direct {
  interface "*";
};

protocol kernel {
  export filter {
{% if source_ipv4 is defined %}
    krt_prefsrc = {{ source_ipv4 }};
{% endif %}
    accept;
  };
};
{% if routing_tables is defined %}
{% for table in routing_tables | default([]) %}

table {{ table.name }};
protocol kernel kernel_{{ table.name }} {
  table {{ table.name }};
  kernel table {{ table.kernel_table }};
  import all;
  export all;
};
{% endfor %}
{% endif %}

protocol device {
  scan time 10;
};

include "{{ bird_config_dir }}/bird.d/as-sets/*.conf";
include "{{ bird_config_dir }}/bird.d/*.conf";

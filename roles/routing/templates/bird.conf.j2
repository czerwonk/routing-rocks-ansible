define DRAINED = false;

log syslog all;
router id {{ router_id }};
timeformat protocol "%s";

protocol direct direct4 {
  ipv4;
  interface "*";
}

protocol direct direct6 {
  ipv6;
  interface "*";
}

protocol kernel kernel4 {
  ipv4 {
    export filter {
  {% if source_ipv4 is defined %}
      krt_prefsrc = {{ source_ipv4 }};
  {% endif %}
      accept;
    };
  };
}

protocol kernel kernel6 {
  ipv6 {
    export filter {
  {% if source_ipv6 is defined %}
      krt_prefsrc = {{ source_ipv6 }};
  {% endif %}
      accept;
    };
  };
}
{% if routing_tables is defined %}
{% for table in routing_tables | default([]) %}

table {{ table.name }};
protocol kernel kernel_{{ table.name }} {
  table {{ table.name }};
  kernel table {{ table.kernel_table }};
  ipv4 {
    import all;
    export all;
  };
  ipv6 {
    import all;
    export all;
  };
}
{% endfor %}
{% endif %}

protocol device {
  scan time 10;
}

include "{{ bird_config_dir }}/bird.d/as-sets/*.conf";
include "{{ bird_config_dir }}/bird.d/*.conf";
